<!DOCTYPE html><html lang="ja"><head>  <meta charset="UTF-8">  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>😸</text></svg>">  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0"><title>へのにっき</title>  <style>::selection{background-color:rgba(255,0,106,.3);text-shadow:2px 3px 9px #9e2c72}body{margin:0;padding:20px;background-color:rgba(255,253,245,.788);font-family:serif;color:#530c38}table{border-collapse:collapse;width:100%;max-width:975pt;margin:0 auto;box-shadow:#cfff82a1 -3px -3px 90px}h1{text-align:center;margin-bottom:20px;font-size:30px;color:#530c38}th{word-break:keep-all;font-size:20px;letter-spacing:1px}td,th{border:1px solid #b2cfdb;padding:8px;text-align:left}#controls{margin-bottom:20px;flex-wrap:wrap;justify-content:center;gap:10px}#controls,#yearControl{display:flex;align-items:center}#yearControl{background-color:#f0f0f080;border-radius:1pc;padding:5px;box-shadow:#c4d8e0a1 -3px -3px 1pc}#yearControl button{background-color:transparent;border:0;font-size:20px;cursor:pointer;padding:5px 10px}#currentYear{font-size:20px;margin:2px 4px;cursor:pointer}#floatingControls{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);background:hsla(0,0%,100%,.8);border:1px solid #ccc;padding:10px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.1);z-index:1}#floatingControls input[type="text"]{margin-right:10px}#dayFilters,#specialFilters{display:flex;gap:10px;margin-top:10px}#dayFilters label,#specialFilters button{background:hsla(0,0%,100%,.8);border:1px solid #ccc;padding:5px 10px;border-radius:5px;cursor:pointer}#dayFilters label:hover,#specialFilters button:hover{background:hsla(0,0%,78%,.8)}.saturday{background-color:#e6feff83}.sunday{background-color:#ffe6f281}.holiday{background-color:#ffe6e680}.editable{min-width:200px}.hidden{display:none}th{text-align:center}td:nth-child(1),td:nth-child(2),td:nth-child(3){text-align:center;font-weight:700}td:nth-child(1){font-size:18px;white-space:nowrap}td:nth-child(3){word-break:keep-all;letter-spacing:-2px}td:nth-child(4){letter-spacing:-1px;line-height:29px;font-feature-settings:palt\ 1;font-size:17px}@media(max-width:650px){td:nth-child(2),td:nth-child(3),th{display:none}td:nth-child(1),td:nth-child(4){display:block;width:auto;border-bottom:0}td:nth-child(1){order:1;width:auto}td:nth-child(4){order:2;font-size:14px;padding:10px}tr{display:flex;flex-direction:column}table{width:100%}}#searchContainer{position:fixed;bottom:0;left:0;right:0;padding:10px;display:flex;justify-content:center}#searchInput{width:300px;padding:10px;font-size:18px;border:1px solid #ccc;background-color:#ffffff80;border-radius:20px;text-align:center}.highlight{background-color:#dfffdf;cursor:pointer}</style></head>
<body><table id="diaryTable"><thead><tr><th>日付</th><th>曜</th><th>祝祭日</th><th>どうした</th></tr></thead><tbody id="diaryBody"></tbody></table>
<script>let entrydata={},holidays=[];const dayNames=["日","月","火","水","木","金","土"];let currentDate=new Date,currentYear=currentDate.getFullYear();const diaryBody=document.getElementById("diaryBody");async function loadJSONData(){try{let[t,e]=await Promise.all([fetch("holidays.json"),fetch("diary.json"),]),[a,n]=await Promise.all([t.json(),e.json()]);holidays=a.holidays;let l=localStorage.getItem("diaryData");for(let r in entrydata=l?JSON.parse(l):{},n)entrydata[r]&&""!==entrydata[r]||(entrydata[r]=n[r]);saveToLocalStorage()}catch(o){console.error("データの読み込みに失敗",o)}}function saveToLocalStorage(){localStorage.setItem("diaryData",JSON.stringify(entrydata))}function loadYear(t){currentYear=t;let e=document.getElementById("diaryBody");e.innerHTML="";let a=new Date(2023,5,1),n=new Date(2031,11,31),l=document.createDocumentFragment();for(let r=new Date(a);r<=n;r.setDate(r.getDate()+1)){let o=document.createElement("tr"),d=document.createElement("td"),i=document.createElement("td"),s=document.createElement("td"),c=document.createElement("td"),y=`${r.getFullYear()}-${(r.getMonth()+1).toString().padStart(2,"0")}-${r.getDate().toString().padStart(2,"0")}`;d.textContent=y,i.textContent=dayNames[r.getDay()],c.className="editable",c.contentEditable=!0,c.textContent=entrydata[y]||"",0===r.getDay()?o.classList.add("sunday"):6===r.getDay()&&o.classList.add("saturday");let g=holidays.find(t=>t.date===y);g&&(o.classList.add("holiday"),s.textContent=g.name),o.appendChild(d),o.appendChild(i),o.appendChild(s),o.appendChild(c),l.appendChild(o)}e.appendChild(l);let m=new Date,u=`${m.getFullYear()}-${(m.getMonth()+1).toString().padStart(2,"0")}-${m.getDate().toString().padStart(2,"0")}`,h=Array.from(e.getElementsByTagName("tr")).find(t=>t.cells[0].textContent===u);h&&(h.scrollIntoView({behavior:"smooth",block:"center"}),h.style.transition="background-color 0.5s",h.style.backgroundColor="#ffeb3b50",setTimeout(()=>{h.style.backgroundColor=""},200))}function filterRows(t){document.querySelectorAll("#diaryBody tr").forEach(e=>{t(e)?e.classList.remove("hidden"):e.classList.add("hidden")})}function filterSameDate(t){let e=`${t.getMonth()+1}-${t.getDate()}`;filterRows(t=>{let[a,n,l]=t.cells[0].textContent.split("-");return`${n}-${l}`===e||t.cells[0].textContent===todayFormatted})}function filterSameDay(t){let e=t.getDay();filterRows(a=>{let n=["月","火","水","木","金","土","日"].indexOf(a.cells[1].textContent),l=new Date(a.cells[0].textContent);return n===e&&l<=t&&a.cells[3].textContent.trim().length>0||a.cells[0].textContent===todayFormatted})}document.getElementById("diaryBody").addEventListener("input",t=>{if("editable"===t.target.className){let e=t.target.parentElement.cells[0].textContent,a=t.target.textContent;entrydata[e]=a,saveToLocalStorage()}}),document.addEventListener("keydown",t=>{if(t.ctrlKey&&"s"===t.key){t.preventDefault();let e=JSON.stringify(entrydata,null,2);navigator.clipboard.writeText(e).then(()=>{window.open("https://github.com/buzomo/diary/edit/main/diary.json")}).catch(t=>{alert("コピーに失敗しました: "+t)})}}),document.addEventListener("DOMContentLoaded",async()=>{await loadJSONData(),loadYear(currentYear);let t=new Date,e=`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`,a=Array.from(diaryBody.getElementsByTagName("tr")).find(t=>t.cells[0].textContent===e);a&&(a.scrollIntoView({behavior:"smooth",block:"center"}),a.style.transition="background-color 0.5s",a.style.backgroundColor="#ffeb3b50",setTimeout(()=>{a.style.backgroundColor=""},200),a.cells[0].addEventListener("click",()=>filterSameDate(t)),a.cells[1].addEventListener("click",()=>filterSameDay(t))),document.querySelectorAll(".editable").forEach(t=>{t.addEventListener("mouseup",t=>{setTimeout(()=>{let t=window.getSelection().toString().trim();if(t.length>0){let e=document.getElementById("searchInput");e.value=t,e.dispatchEvent(new Event("input"))}},300)})})}),document.getElementById("searchInput").addEventListener("input",t=>{let e=t.target.value.toLowerCase();if(""===e){let a=new Date,n=`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`,l=Array.from(diaryBody.getElementsByTagName("tr")).find(t=>t.cells[0].textContent===n);l&&l.scrollIntoView({behavior:"smooth",block:"center"})}filterRows(t=>t.cells[3].textContent.toLowerCase().includes(e)?(t.classList.remove("hidden"),!0):(t.classList.add("hidden"),!1))});</script></body>