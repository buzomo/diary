
<html lang="ja"><head>
  <meta charset="UTF-8">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ˜¸</text></svg>">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">

  <title>ã¸ã®ã«ã£ã</title>
  <link rel="stylesheet" href="style.css"> 
</head>
<body>
  <div id="controls">
    <div id="yearControl">
      <button id="prevYear">â—€</button>
      <span id="currentYear"></span>
      <button id="nextYear">â–¶</button>
    </div>
  </div>

  <table id="diaryTable">
    <thead>
      <tr>
        <th>æ—¥ä»˜</th>
        <th>æ›œæ—¥</th>
        <th>ç¥ç¥­æ—¥</th>
        <th>ã©ã†ã—ãŸ</th>
      </tr>
    </thead>
    <tbody id="diaryBody"></tbody>
  </table>

    <script>

    let entrydata = {};
    const holidays = [
    { date: "2023-01-01", name: "å…ƒæ—¦" },
    { date: "2023-01-09", name: "æˆäººã®æ—¥" },
    { date: "2023-02-11", name: "å»ºå›½è¨˜å¿µã®æ—¥" },
    { date: "2023-02-23", name: "å¤©çš‡èª•ç”Ÿæ—¥" },
    { date: "2023-03-21", name: "æ˜¥åˆ†ã®æ—¥" },
    { date: "2023-04-29", name: "æ˜­å’Œã®æ—¥" },
    { date: "2023-05-03", name: "æ†²æ³•è¨˜å¿µæ—¥" },
    { date: "2023-05-04", name: "ã¿ã©ã‚Šã®æ—¥" },
    { date: "2023-05-05", name: "ã“ã©ã‚‚ã®æ—¥" },
    { date: "2023-07-17", name: "æµ·ã®æ—¥" },
    { date: "2023-08-11", name: "å±±ã®æ—¥" },
    { date: "2023-09-18", name: "æ•¬è€ã®æ—¥" },
    { date: "2023-09-23", name: "ç§‹åˆ†ã®æ—¥" },
    { date: "2023-10-09", name: "ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥" },
    { date: "2023-11-03", name: "æ–‡åŒ–ã®æ—¥" },
    { date: "2023-11-23", name: "å‹¤åŠ´æ„Ÿè¬ã®æ—¥" },
    { date: "2024-01-01", name: "å…ƒæ—¦" },
    { date: "2024-01-08", name: "æˆäººã®æ—¥" },
    { date: "2024-02-11", name: "å»ºå›½è¨˜å¿µã®æ—¥" },
    { date: "2024-02-12", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2024-02-23", name: "å¤©çš‡èª•ç”Ÿæ—¥" },
    { date: "2024-03-20", name: "æ˜¥åˆ†ã®æ—¥" },
    { date: "2024-04-29", name: "æ˜­å’Œã®æ—¥" },
    { date: "2024-05-03", name: "æ†²æ³•è¨˜å¿µæ—¥" },
    { date: "2024-05-04", name: "ã¿ã©ã‚Šã®æ—¥" },
    { date: "2024-05-05", name: "ã“ã©ã‚‚ã®æ—¥" },
    { date: "2024-05-06", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2024-07-15", name: "æµ·ã®æ—¥" },
    { date: "2024-08-11", name: "å±±ã®æ—¥" },
    { date: "2024-08-12", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2024-09-16", name: "æ•¬è€ã®æ—¥" },
    { date: "2024-09-22", name: "ç§‹åˆ†ã®æ—¥" },
    { date: "2024-09-23", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2024-10-14", name: "ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥" },
    { date: "2024-11-03", name: "æ–‡åŒ–ã®æ—¥" },
    { date: "2024-11-04", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2024-11-23", name: "å‹¤åŠ´æ„Ÿè¬ã®æ—¥" },
    { date: "2024-12-28", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2024-12-29", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2024-12-30", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2024-12-31", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2025-01-01", name: "å…ƒæ—¥" },
    { date: "2025-01-02", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2025-01-03", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2025-01-04", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2025-01-05", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2025-01-13", name: "æˆäººã®æ—¥" },
    { date: "2025-02-11", name: "å»ºå›½è¨˜å¿µã®æ—¥" },
    { date: "2025-02-23", name: "å¤©çš‡èª•ç”Ÿæ—¥" },
    { date: "2025-02-24", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2025-03-20", name: "æ˜¥åˆ†ã®æ—¥" },
    { date: "2025-04-29", name: "æ˜­å’Œã®æ—¥" },
    { date: "2025-05-03", name: "æ†²æ³•è¨˜å¿µæ—¥" },
    { date: "2025-05-04", name: "ã¿ã©ã‚Šã®æ—¥" },
    { date: "2025-05-05", name: "ã“ã©ã‚‚ã®æ—¥" },
    { date: "2025-05-06", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2025-07-21", name: "æµ·ã®æ—¥" },
    { date: "2025-08-11", name: "å±±ã®æ—¥" },
    { date: "2025-09-15", name: "æ•¬è€ã®æ—¥" },
    { date: "2025-09-23", name: "ç§‹åˆ†ã®æ—¥" },
    { date: "2025-10-13", name: "ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥" },
    { date: "2025-11-03", name: "æ–‡åŒ–ã®æ—¥" },
    { date: "2025-11-23", name: "å‹¤åŠ´æ„Ÿè¬ã®æ—¥" },
    { date: "2025-11-24", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2025-12-29", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2025-12-30", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2025-12-31", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2026-01-01", name: "å…ƒæ—¥" },
    { date: "2026-01-02", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2026-01-03", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2026-01-04", name: "å¹´æœ«å¹´å§‹ä¼‘æš‡" },
    { date: "2026-01-12", name: "æˆäººã®æ—¥" },
    { date: "2026-01-01", name: "å…ƒæ—¥" },
    { date: "2026-01-12", name: "æˆäººã®æ—¥" },
    { date: "2026-02-11", name: "å»ºå›½è¨˜å¿µã®æ—¥" },
    { date: "2026-02-23", name: "å¤©çš‡èª•ç”Ÿæ—¥" },
    { date: "2026-03-20", name: "æ˜¥åˆ†ã®æ—¥" },
    { date: "2026-04-29", name: "æ˜­å’Œã®æ—¥" },
    { date: "2026-05-03", name: "æ†²æ³•è¨˜å¿µæ—¥" },
    { date: "2026-05-04", name: "ã¿ã©ã‚Šã®æ—¥" },
    { date: "2026-05-05", name: "ã“ã©ã‚‚ã®æ—¥" },
    { date: "2026-05-06", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2026-07-20", name: "æµ·ã®æ—¥" },
    { date: "2026-08-11", name: "å±±ã®æ—¥" },
    { date: "2026-09-21", name: "æ•¬è€ã®æ—¥" },
    { date: "2026-09-22", name: "å›½æ°‘ã®ä¼‘æ—¥" },
    { date: "2026-09-23", name: "ç§‹åˆ†ã®æ—¥" },
    { date: "2026-10-12", name: "ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥" },
    { date: "2026-11-03", name: "æ–‡åŒ–ã®æ—¥" },
    { date: "2026-11-23", name: "å‹¤åŠ´æ„Ÿè¬ã®æ—¥" },
    { date: "2027-01-01", name: "å…ƒæ—¥" },
    { date: "2027-01-11", name: "æˆäººã®æ—¥" },
    { date: "2027-02-11", name: "å»ºå›½è¨˜å¿µã®æ—¥" },
    { date: "2027-02-23", name: "å¤©çš‡èª•ç”Ÿæ—¥" },
    { date: "2027-03-21", name: "æ˜¥åˆ†ã®æ—¥" },
    { date: "2027-03-22", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2027-04-29", name: "æ˜­å’Œã®æ—¥" },
    { date: "2027-05-03", name: "æ†²æ³•è¨˜å¿µæ—¥" },
    { date: "2027-05-04", name: "ã¿ã©ã‚Šã®æ—¥" },
    { date: "2027-05-05", name: "ã“ã©ã‚‚ã®æ—¥" },
    { date: "2027-07-19", name: "æµ·ã®æ—¥" },
    { date: "2027-08-11", name: "å±±ã®æ—¥" },
    { date: "2027-09-20", name: "æ•¬è€ã®æ—¥" },
    { date: "2027-09-23", name: "ç§‹åˆ†ã®æ—¥" },
    { date: "2027-10-11", name: "ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥" },
    { date: "2027-11-03", name: "æ–‡åŒ–ã®æ—¥" },
    { date: "2027-11-23", name: "å‹¤åŠ´æ„Ÿè¬ã®æ—¥" },
    { date: "2028-01-01", name: "å…ƒæ—¥" },
    { date: "2028-01-10", name: "æˆäººã®æ—¥" },
    { date: "2028-02-11", name: "å»ºå›½è¨˜å¿µã®æ—¥" },
    { date: "2028-02-23", name: "å¤©çš‡èª•ç”Ÿæ—¥" },
    { date: "2028-03-20", name: "æ˜¥åˆ†ã®æ—¥" },
    { date: "2028-04-29", name: "æ˜­å’Œã®æ—¥" },
    { date: "2028-05-03", name: "æ†²æ³•è¨˜å¿µæ—¥" },
    { date: "2028-05-04", name: "ã¿ã©ã‚Šã®æ—¥" },
    { date: "2028-05-05", name: "ã“ã©ã‚‚ã®æ—¥" },
    { date: "2028-07-17", name: "æµ·ã®æ—¥" },
    { date: "2028-08-11", name: "å±±ã®æ—¥" },
    { date: "2028-09-18", name: "æ•¬è€ã®æ—¥" },
    { date: "2028-09-22", name: "ç§‹åˆ†ã®æ—¥" },
    { date: "2028-10-09", name: "ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥" },
    { date: "2028-11-03", name: "æ–‡åŒ–ã®æ—¥" },
    { date: "2028-11-23", name: "å‹¤åŠ´æ„Ÿè¬ã®æ—¥" },
    { date: "2029-01-01", name: "å…ƒæ—¥" },
    { date: "2029-01-08", name: "æˆäººã®æ—¥" },
    { date: "2029-02-11", name: "å»ºå›½è¨˜å¿µã®æ—¥" },
    { date: "2029-02-12", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2029-02-23", name: "å¤©çš‡èª•ç”Ÿæ—¥" },
    { date: "2029-03-20", name: "æ˜¥åˆ†ã®æ—¥" },
    { date: "2029-04-29", name: "æ˜­å’Œã®æ—¥" },
    { date: "2029-04-30", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2029-05-03", name: "æ†²æ³•è¨˜å¿µæ—¥" },
    { date: "2029-05-04", name: "ã¿ã©ã‚Šã®æ—¥" },
    { date: "2029-05-05", name: "ã“ã©ã‚‚ã®æ—¥" },
    { date: "2029-07-16", name: "æµ·ã®æ—¥" },
    { date: "2029-08-11", name: "å±±ã®æ—¥" },
    { date: "2029-09-17", name: "æ•¬è€ã®æ—¥" },
    { date: "2029-09-23", name: "ç§‹åˆ†ã®æ—¥" },
    { date: "2029-09-24", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2029-10-08", name: "ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥" },
    { date: "2029-11-03", name: "æ–‡åŒ–ã®æ—¥" },
    { date: "2029-11-23", name: "å‹¤åŠ´æ„Ÿè¬ã®æ—¥" },
    { date: "2030-01-01", name: "å…ƒæ—¥" },
    { date: "2030-01-14", name: "æˆäººã®æ—¥" },
    { date: "2030-02-11", name: "å»ºå›½è¨˜å¿µã®æ—¥" },
    { date: "2030-02-23", name: "å¤©çš‡èª•ç”Ÿæ—¥" },
    { date: "2030-03-20", name: "æ˜¥åˆ†ã®æ—¥" },
    { date: "2030-04-29", name: "æ˜­å’Œã®æ—¥" },
    { date: "2030-05-03", name: "æ†²æ³•è¨˜å¿µæ—¥" },
    { date: "2030-05-04", name: "ã¿ã©ã‚Šã®æ—¥" },
    { date: "2030-05-05", name: "ã“ã©ã‚‚ã®æ—¥" },
    { date: "2030-05-06", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2030-07-15", name: "æµ·ã®æ—¥" },
    { date: "2030-08-11", name: "å±±ã®æ—¥" },
    { date: "2030-08-12", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2030-09-16", name: "æ•¬è€ã®æ—¥" },
    { date: "2030-09-23", name: "ç§‹åˆ†ã®æ—¥" },
    { date: "2030-10-14", name: "ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥" },
    { date: "2030-11-03", name: "æ–‡åŒ–ã®æ—¥" },
    { date: "2030-11-04", name: "æŒ¯æ›¿ä¼‘æ—¥" },
    { date: "2030-11-23", name: "å‹¤åŠ´æ„Ÿè¬ã®æ—¥" },
  ];

    const dayNames = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
    let currentDate = new Date();
    let currentYear = currentDate.getFullYear();
    let activeDays = new Set([0, 1, 2, 3, 4, 5, 6]);
    const yearControl = document.getElementById("yearControl");
    const diaryBody = document.getElementById("diaryBody");
    async function loadFromJSON() {
      try {
        const response = await fetch('backupData.json');
        const parsed = await response.json();
        // LocalStorageã®ãƒ‡ãƒ¼ã‚¿ã¨JSONã®ãƒ‡ãƒ¼ã‚¿ã‚’çµ±åˆ
        for (let key in parsed) {
          if (!entrydata[key] || entrydata[key] === "") {
            entrydata[key] = parsed[key];
          }
        }
        saveToLocalStorage();
      } catch (e) {
        console.error("JSONãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—", e);
      }
    }


    function loadFromLocalStorage() {
      const savedData = localStorage.getItem("diaryData");
      if (savedData) {
        entrydata = JSON.parse(savedData);
      }
    }

    function saveToLocalStorage() {
      localStorage.setItem("diaryData", JSON.stringify(entrydata));
    }

    function filterTable() {
      const rows = document.querySelectorAll("#diaryBody tr");

      rows.forEach((row) => {
        const dayOfWeek = row.cells[1].textContent;
        const dayIndex = dayNames.indexOf(dayOfWeek);
        const contentCell = row.cells[3];
        const content = contentCell.textContent.toLowerCase();

        const matchDay = activeDays.has(dayIndex);

        if (matchDay) {
          row.classList.remove("hidden");

          contentCell.textContent = contentCell.textContent;
        } else {
          row.classList.add("hidden");
        }
      });
    }
    function loadYear(year) {
      currentYear = year;

      const table = document.getElementById("diaryBody");
      table.innerHTML = "";

      const startDate = new Date(year, 0, 1);
      const endDate = new Date(year, 11, 31);

      for (
        let d = new Date(startDate);
        d <= endDate;
        d.setDate(d.getDate() + 1)
      ) {
        const row = table.insertRow();
        const dateCell = row.insertCell(0);
        const dayCell = row.insertCell(1);
        const holidayCell = row.insertCell(2);
        const contentCell = row.insertCell(3);

        const formattedDate = `${d.getFullYear()}-${(d.getMonth() + 1)
          .toString()
          .padStart(2, "0")}-${d.getDate().toString().padStart(2, "0")}`;
        dateCell.textContent = formattedDate;
        dayCell.textContent = dayNames[d.getDay()];

        contentCell.className = "editable";
        contentCell.contentEditable = true;
        contentCell.textContent = entrydata[formattedDate] || "";

        if (d.getDay() === 0) {
          row.classList.add("sunday");
        } else if (d.getDay() === 6) {
          row.classList.add("saturday");
        }

        const holiday = holidays.find((h) => h.date === formattedDate);
        if (holiday) {
          row.classList.add("holiday");
          holidayCell.textContent = holiday.name;
        }
      }

      filterTable();
      const today = new Date();
      const todayFormatted = `${today.getFullYear()}-${(today.getMonth() + 1)
        .toString()
        .padStart(2, "0")}-${today.getDate().toString().padStart(2, "0")}`;
      const todayRow = Array.from(table.getElementsByTagName("tr")).find(
        (row) => row.cells[0].textContent === todayFormatted
      );
      document.getElementById("currentYear").textContent = year;
      if (todayRow) {
        todayRow.scrollIntoView({ behavior: "smooth", block: "center" });
        todayRow.style.transition = "background-color 1s";
        todayRow.style.backgroundColor = "#ffeb3b50";
        setTimeout(() => {
          todayRow.style.backgroundColor = "";
        }, 2000);
      }
    }

    document
      .getElementById("prevYear")
      .addEventListener("click", () => loadYear(currentYear - 1));
    document
      .getElementById("nextYear")
      .addEventListener("click", () => loadYear(currentYear + 1));

    document.getElementById("diaryBody").addEventListener("input", (e) => {
      if (e.target.className === "editable") {
        const row = e.target.parentElement;
        const date = row.cells[0].textContent;
        const content = e.target.textContent;
        entrydata[date] = content;
        saveToLocalStorage();
      }
    });

    document.addEventListener("keydown", (e) => {
      if (e.ctrlKey && e.key === "s") {
        e.preventDefault();
        const dataToCopy = JSON.stringify(entrydata);
        navigator.clipboard
          .writeText(dataToCopy)
          .then(() => {
            showToast("æœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
          })
          .catch((err) => {
            showToast("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ: " + err);
          });
        setTimeout(() => {
          location.href = "https://github.com/buzomo/toh-diary/edit/main/index.html";
        }, 3000);
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      loadFromLocalStorage();
      loadFromJSON();
      loadYear(currentYear);
    });
  </script>


</body></html>
